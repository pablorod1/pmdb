---
import Layout from '../layouts/Layout.astro';
import ChevronRight from '../icons/ChevronRight.astro';
import ChevronLeft from '../icons/ChevronLeft.astro';

import { getPopularMovies } from '../lib/tmdb';

const popularMovies = await getPopularMovies();
const carouselMovies = popularMovies.slice(0, 5);
---

<Layout title="Welcome to Astro.">
	<main>
		<div class="glide pb-16">
			<div class="glide__track mx-12" data-glide-el="track">
				<ul class="glide__slides">
					{
						carouselMovies.map((movie: any) => {
							return (
								<li class="glide__slide ">
									<img src={`https://image.tmdb.org/t/p/original${movie.backdrop_path}`} alt="" />
								</li>
							)
						})
					}
				</ul>
			</div>
	
			<div class="glide__arrows" data-glide-el="controls">
				<button class="glide__arrow glide__arrow--left " data-glide-dir="<" style="border: 0;"><ChevronLeft class="size-14"/></button>
				<button class="glide__arrow glide__arrow--right " data-glide-dir=">" style="border: 0;"><ChevronRight class="size-14"/></button>
			</div>
	
			<div class="glide__bullets" data-glide-el="controls[nav]">
				{
					carouselMovies.map((movie: any, index: number) => (
						<button class="glide__bullet" data-glide-dir={`=${index}`}></button>
					))
				}
			</div>
		</div>

		<div class="flex flex-col px-24">
			<h1 class="text-white font-bold text-3xl">Tendencias</h1>
			<div class="py-12">
				{
					popularMovies.map((movie: any) => (
					<div class="glide__track mx-12" data-glide-el="track">
						<ul class="glide__slides">
							<li class="glide__slide ">
								
							</li>
						</ul>
					</div>
					))
				}
			</div>
		</div>
	</main>
</Layout>

<style is:global>
	.glide__track{
		overflow: visible !important;
	}
	.glide__arrows{
		opacity: 0;
		transition: opacity 0.3s;
	}
	.glide:hover .glide__arrows{
		opacity: 1;
	}
	.glide__slide:not(.glide__slide--active){
		transition: opacity 0.3s ease;
	}
	.glide__slide{
		border-radius: .5rem;
		overflow: hidden;
	}
	.glide__slide img{
		width: 100%;
		object-fit: cover;
		max-height: 600px;
		height: 100%;
	}
	.glide__slide--active{	
		border: 2px solid transparent;
		box-shadow: rgba(0, 0, 0, 0.8) 0px 26px 30px , rgba(0, 0, 0,1) 0px 16px 10px -10px;
		transition: border 0.2s ease, opacity 0.2s ease, box-shadow 0.3s ease;
	}
	.glide__slide--active:hover{
		border: 2px solid white;
	}
	.glide__arrow--left{
		left: -.5rem !important;
	}
	.glide__arrow--right{
		right: -1rem !important;
	}
	.glide__slide:not(.glide__slide--active){
		opacity: 0.5;
	}
	.glide__slides{
		overflow: visible !important;
	}
</style>

<script>
  import "../lib/carousel.js";
</script>

